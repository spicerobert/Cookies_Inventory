# Google Sheets 工作表說明

本系統使用 Google Sheets 作為資料來源和結果輸出的介面。以下說明各個工作表的用途和欄位定義。

**重要說明**：為了簡化資料表結構，所有工作表只保留代號欄位，名稱統一在 **Index** 工作表中維護。這樣可以減少資料冗餘，維護更方便。

## 輸入資料工作表（由使用者填入）

### 0. Index（代號對應表）⭐ 請優先填入
**用途**：存放所有代號與名稱的對應關係，是所有工作表的基礎資料

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 類型 | 項目類型 | 餅乾 / 禮盒 / 產線 |
| 代號 | 唯一識別碼 | COOKIE001 / BOX001 / LINE_A |
| 名稱 | 項目名稱 | 奶油餅乾 / 經典禮盒 / 產線A |
| 備註 | 其他說明 | - |

**填寫範例**：
```
類型     | 代號      | 名稱     | 備註
---------|-----------|----------|-----
餅乾     | COOKIE001 | 奶油餅乾 | 
餅乾     | COOKIE002 | 巧克力餅乾 | 
禮盒     | BOX001    | 經典禮盒 | 
禮盒     | BOX002    | 豪華禮盒 | 
產線     | LINE_A    | 產線A    | 
產線     | LINE_B    | 產線B    | 
```

**注意事項**：
- 此工作表必須最先建立和維護
- 類型欄位建議使用：`餅乾`、`禮盒`、`產線`
- 代號必須唯一，不可重複

---

### 1. BOM（禮盒組成表）
**用途**：定義每一款禮盒的餅乾組成

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 餅乾代號 | 餅乾的唯一識別碼 | COOKIE001 |
| 每盒片數 | 每個禮盒需要此餅乾的片數 | 8 |
| 備註 | 其他說明 | - |

**注意**：
- 同一款禮盒會有多筆記錄，每一筆代表一種餅乾
- 禮盒名稱和餅乾名稱請參考 Index 工作表

---

### 2. 組裝計劃
**用途**：後段組裝作業的排程計畫

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 日期 | 組裝日期 | 2024/01/15 |
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 計畫組裝數量 | 計畫組裝的禮盒數量 | 500 |
| 已完成數量 | 目前已完成的數量（系統會更新） | 0 |
| 狀態 | 組裝狀態（系統會更新） | 待開始 |
| 備註 | 其他說明 | - |

**注意**：禮盒名稱請參考 Index 工作表

---

### 3. 出貨預測
**用途**：預估出貨計畫，用於決定組裝和生產的優先順序

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 出貨日期 | 預估出貨日期 | 2024/01/25 |
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 預估出貨數量 | 預估的出貨數量 | 1000 |
| 客戶類別 | 客戶類別（選填） | 通路商 |
| 備註 | 其他說明 | - |

**注意**：禮盒名稱請參考 Index 工作表

---

### 4. 實盤庫存
**用途**：目前餅乾的實盤庫存狀況（手動更新）

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 餅乾代號 | 餅乾的唯一識別碼 | COOKIE001 |
| 餅乾品名 | 餅乾名稱 | 奶油餅乾 |
| 目前庫存數量 | 目前的庫存數量（片） | 5000 |
| 庫別代號 | 庫別代號（SP40, SP50, SP60, SP80） | SP40 |
| 單位 | 單位 | 片 |
| 最後更新日期 | 最後更新日期 | 2024/01/10 |

**注意**：
- 此工作表為手動更新，用於記錄實盤盤點的庫存數量
- 此工作表用於計算庫存預估的期初庫存基準
- 餅乾名稱請參考 Index 工作表
- 多庫別會按餅乾代號分別記錄

---

### 5. 成品庫存
**用途**：目前禮盒成品的庫存狀況

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 目前庫存數量 | 目前的庫存數量 | 200 |
| 單位 | 單位 | 盒 |
| 最後更新日期 | 最後更新日期 | 2024/01/10 |

**注意**：禮盒名稱請參考 Index 工作表

---

### 6. 生產參數
**用途**：餅乾生產的技術參數和限制

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 餅乾代號 | 餅乾的唯一識別碼 | COOKIE001 |
| 產線歸屬 | 可用的產線（例如：A,B,C 或 ALL） | A,B |
| 每小時產量_片 | 每小時可生產的片數 | 500 |
| 前置天數_天 | 從投料到完工所需的天數 | 2 |
| 最小批量_片 | 最小生產批量 | 1000 |
| 換線分類 | 換線分類（用於優化排程） | I類 |
| 備註 | 其他說明 | - |

**換線分類說明**：
- 同一分類的餅乾換線時間較短
- 不同分類之間換線需要較長時間（標準0.5小時）
- 可用數字（I類、II類）或文字描述（甜味、鹹味、含堅果等）

**注意**：餅乾名稱請參考 Index 工作表

---

### 7. 組裝產能
**用途**：後段組裝線的產能參數

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 組裝速度_盒每小時每人 | 每人每小時可組裝的盒數 | 20 |
| 每日最大產能_盒 | 每日最大可組裝的盒數 | 1600 |
| 備註 | 其他說明 | - |

**注意**：禮盒名稱請參考 Index 工作表

---

### 8. 產線產能
**用途**：前段生產線的產能參數

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 產線代號 | 產線的唯一識別碼 | LINE_A |
| 每日最大產能_小時 | 每日最大可用工時（扣除休息和換線時間） | 9.5 |
| 備註 | 其他說明 | - |

**注意事項**：
- 每日工作時間：10小時
- 扣除換線時間：0.5小時/次
- 扣除員工休息時間：根據實際情況設定
- 產線名稱請參考 Index 工作表

---

### 9. 訂單與預測
**用途**：需求數據（訂單和銷售預測）

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 禮盒代號 | 禮盒的唯一識別碼 | BOX001 |
| 總目標銷售數量 | 總目標銷售數量 | 10000 |
| 已確認訂單數量 | 已確認的訂單數量 | 3000 |
| 預測數量 | 預測的銷售數量 | 7000 |
| 單位 | 單位 | 盒 |
| 備註 | 其他說明 | - |

**注意**：禮盒名稱請參考 Index 工作表

---

## 系統輸出工作表（由系統計算並寫入）

### 10. 生產排程建議
**用途**：系統自動建議的餅乾生產排程

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 日期 | 生產日期 | 2024/01/15 |
| 產線代號 | 產線代號 | LINE_A |
| 餅乾代號 | 餅乾代號 | COOKIE001 |
| 建議生產數量_片 | 建議生產的數量 | 5000 |
| 預計開始時間 | 預計開始生產時間 | 08:00 |
| 預計完成時間 | 預計完成時間 | 18:00 |
| 狀態 | 狀態（建議/已確認/進行中/已完成） | 建議 |
| 備註 | 其他說明 | - |

**注意**：餅乾名稱和產線名稱請參考 Index 工作表

---

### 11. 組裝調整建議
**用途**：當餅乾產能不足時，系統建議的組裝計畫調整

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 原始日期 | 原始計畫的組裝日期 | 2024/01/20 |
| 調整後日期 | 調整後的組裝日期 | 2024/01/22 |
| 禮盒代號 | 禮盒代號 | BOX001 |
| 原始數量 | 原始計畫數量 | 500 |
| 調整後數量 | 調整後數量 | 400 |
| 調整原因 | 調整的原因說明 | 餅乾COOKIE001產能不足 |
| 狀態 | 狀態（建議/已確認/已執行） | 建議 |

**注意**：禮盒名稱請參考 Index 工作表

---

### 12. 齊料缺口分析
**用途**：分析哪些禮盒因為缺哪些餅乾而無法組裝

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 日期 | 組裝日期 | 2024/01/20 |
| 禮盒代號 | 禮盒代號 | BOX001 |
| 缺料餅乾代號 | 缺少的餅乾代號 | COOKIE001 |
| 缺口數量_片 | 缺口數量 | 2000 |
| 優先級 | 優先級（高/中/低） | 高 |
| 狀態 | 狀態 | 待處理 |

**注意**：禮盒名稱和餅乾名稱請參考 Index 工作表

---

## 使用說明

### 資料填入順序建議

1. **Index（代號對應表）** ⭐ **必須優先建立**
   - 填入所有餅乾、禮盒、產線的代號與名稱對應關係

2. **基礎資料**（只需設定一次）：
   - BOM（禮盒組成表）
   - 生產參數
   - 組裝產能
   - 產線產能

3. **動態資料**（需要定期更新）：
   - 實盤庫存（每週更新，手動盤點）
   - 成品庫存（每週更新）
   - 組裝計劃（每週更新）
   - 出貨預測（每週更新）
   - 訂單與預測（每週更新）

4. **系統輸出**（系統自動計算）：
   - 生產排程建議
   - 組裝調整建議
   - 齊料缺口分析

### 資料格式注意事項

- **日期格式**：建議使用 `YYYY/MM/DD` 或 `YYYY-MM-DD` 格式
- **數字格式**：請使用純數字，不要包含千分位符號
- **代號格式**：建議使用統一格式，例如 `BOX001`、`COOKIE001`、`LINE_A`
- **單位**：請保持一致，例如都使用「片」或「盒」
- **名稱查詢**：所有名稱都在 Index 工作表中，其他工作表只使用代號

### 系統執行流程

1. 系統讀取 Index 工作表建立代號對應表
2. 系統讀取上述輸入資料工作表
3. 執行排程計算邏輯
4. 將結果寫入輸出工作表（使用代號，名稱可透過 Index 查詢）

### 名稱查詢方式

在程式中，可以使用 `GoogleSheetsHelper` 的以下方法來查詢名稱：

```python
helper = GoogleSheetsHelper()

# 查詢單一名稱
cookie_name = helper.get_name_by_code('COOKIE001', '餅乾')
box_name = helper.get_name_by_code('BOX001', '禮盒')

# 取得完整的對應字典
index_dict = helper.get_index_dict()
# 結果: {'餅乾': {'COOKIE001': '奶油餅乾', ...}, '禮盒': {...}, '產線': {...}}
```

---

## 技術說明

- **連接方式**：使用 Google Service Account 認證
- **更新頻率**：建議每週執行一次排程計算
- **資料備份**：建議定期備份 Google Sheets 資料
- **資料結構**：採用正規化設計，代號與名稱分離，減少資料冗餘
